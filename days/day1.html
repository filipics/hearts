<div id="day1" class="section">
    <div class="day-header">
        <h2>üá´üá∑ Mi√©rcoles 7 de Enero</h2>
        <p>Llegada ‚Ä¢ Sainte-Chapelle ‚Ä¢ Mus√©e d'Orsay ‚Ä¢ Seine Cruise üåü Reddit Approved</p>
    </div>

    <!-- 1. NEW STATS HEADER -->
    <div class="day-stats-header">
        <div class="stat-pill">
            <i class="fas fa-walking"></i>
            <span>~6 km</span>
            <small>Walking</small>
        </div>
        <div class="stat-pill">
            <i class="fas fa-ticket-alt"></i>
            <span>~48‚Ç¨</span>
            <small>Tickets</small>
        </div>
        <div class="stat-pill">
            <i class="fas fa-utensils"></i>
            <span>~40‚Ç¨</span>
            <small>Food</small>
        </div>
        <div class="stat-pill">
            <i class="fas fa-map-marker-alt"></i>
            <span>7</span>
            <small>Stops</small>
        </div>
    </div>

    <!-- 2. INTERACTIVE MAP -->
    <div class="interactive-map-container">
        <div id="map-day1"></div>
    </div>

    <!-- RAIN TOGGLE -->
    <div class="day-rain-toggle">
        <label onclick="toggleRainMode()">
            <i class="fas fa-cloud-rain"></i>
            <span>¬øLlueve hoy? Ver alternativas techadas</span>
        </label>
        <div class="rain-switch" id="rainSwitch1" onclick="toggleRainMode()"></div>
    </div>

    <!-- 3. REORDERABLE ACTIVITY GRID -->
    <div id="activityGridDay1" class="activity-grid">
        
        <!-- ITEM 1: LLEGADA -->
        <div class="activity-block" data-id="arrival">
            <div class="activity-block-header">
                <span class="activity-time-badge" style="background:#B45309;">08:00</span>
                <div class="activity-icon-badge"><i class="fas fa-plane"></i></div>
            </div>
            <div class="activity-block-title">Llegada a Par√≠s (CDG)</div>
            <div class="activity-block-subtitle">Aeropuerto Charles de Gaulle</div>
            <button class="expand-btn" onclick="toggleDetails(this)">
                Ver detalles <i class="fas fa-chevron-down"></i>
            </button>
            <div class="activity-details-container">
                <div class="detail-box">
                    <i class="fas fa-route"></i>
                    <div class="detail-content">
                        <div class="detail-label">Transfer</div>
                        <div class="detail-value">RER B ‚Üí Ch√¢telet ‚Üí Metro 1</div>
                        <div class="detail-note">~50 min a Le Marais</div>
                    </div>
                </div>
                <div class="detail-box">
                    <i class="fas fa-tag"></i>
                    <div class="detail-content">
                        <div class="detail-label">Costo</div>
                        <div class="detail-value">~11.80‚Ç¨</div>
                        <div class="detail-note">Ticket RER + Metro incluido</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ITEM 2: CHECK-IN -->
        <div class="activity-block" data-id="hotel">
            <div class="activity-block-header">
                <span class="activity-time-badge">09:30</span>
                <div class="activity-icon-badge"><i class="fas fa-hotel"></i></div>
            </div>
            <div class="activity-block-title">Check-in Hotel</div>
            <div class="activity-block-subtitle">H√¥tel Caron de Beaumarchais</div>
            <button class="expand-btn" onclick="toggleDetails(this)">
                Ver detalles <i class="fas fa-chevron-down"></i>
            </button>
            <div class="activity-details-container">
                <div class="detail-box">
                    <i class="fas fa-info-circle"></i>
                    <div class="detail-content">
                        <div class="detail-value">Dejar maletas</div>
                        <div class="detail-note">Check-in oficial es 15:00, pero guardan equipaje.</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ITEM 3: NOTRE DAME -->
        <div class="activity-block" data-id="notre-dame">
            <div class="activity-block-header">
                <span class="activity-time-badge">10:30</span>
                <div class="activity-icon-badge"><i class="fas fa-church"></i></div>
            </div>
            <div class="activity-block-title">Notre Dame</div>
            <div class="activity-block-subtitle">Exterior & √éle de la Cit√©</div>
            <button class="expand-btn" onclick="toggleDetails(this)">
                Ver detalles <i class="fas fa-chevron-down"></i>
            </button>
            <div class="activity-details-container">
                <div class="schedule-tags">
                    <span class="schedule-tag tag-free-entry">Gratis</span>
                </div>
                <p style="font-size:0.85rem; color:#666; margin:10px 0;">Caminata por el exterior y los alrededores. La catedral reabri√≥ en Dic 2024.</p>
                <div class="rain-alternative-enhanced">
                    <div class="rain-header"><i class="fas fa-umbrella"></i> Si llueve:</div>
                    <p style="font-size:0.8rem; margin:0;">Ir directo a Sainte-Chapelle (al lado) o Caf√© Procope.</p>
                </div>
            </div>
        </div>

        <!-- ITEM 4: SAINTE CHAPELLE -->
        <div class="activity-block" data-id="sainte-chapelle">
            <div class="activity-block-header">
                <span class="activity-time-badge">12:00</span>
                <div class="activity-icon-badge"><i class="fas fa-gem"></i></div>
            </div>
            <div class="activity-block-title">Sainte-Chapelle</div>
            <div class="activity-block-subtitle">Los mejores vitrales del mundo</div>
            <button class="expand-btn" onclick="toggleDetails(this)">
                Ver detalles <i class="fas fa-chevron-down"></i>
            </button>
            <div class="activity-details-container">
                <div class="schedule-tags">
                    <span class="schedule-tag tag-ticket">13‚Ç¨ Ticket</span>
                    <span class="schedule-tag tag-reserve">Reservar</span>
                </div>
                <div class="detail-box">
                    <i class="fas fa-star"></i>
                    <div class="detail-content">
                        <div class="detail-label">Highlight</div>
                        <div class="detail-value">Capilla Superior</div>
                        <div class="detail-note">Subir las escaleras de caracol.</div>
                    </div>
                </div>
                <a href="https://www.sainte-chapelle.fr" target="_blank" class="doc-link" style="margin-top:10px; display:inline-block; font-size:0.8rem;">Reservar Ticket</a>
            </div>
        </div>

        <!-- ITEM 5: LUNCH -->
        <div class="activity-block" data-id="lunch">
            <div class="activity-block-header">
                <span class="activity-time-badge" style="background:#EC4899;">13:00</span>
                <div class="activity-icon-badge"><i class="fas fa-utensils"></i></div>
            </div>
            <div class="activity-block-title">L'As du Fallafel</div>
            <div class="activity-block-subtitle">Almuerzo ic√≥nico en Le Marais</div>
            <button class="expand-btn" onclick="toggleDetails(this)">
                Ver detalles <i class="fas fa-chevron-down"></i>
            </button>
            <div class="activity-details-container">
                <div class="schedule-tags">
                    <span class="schedule-tag" style="background:#FEF3C7; color:#B45309;">Reddit Famous</span>
                </div>
                <p style="font-size:0.85rem; margin-top:10px;">El falafel m√°s famoso de Par√≠s. Suele haber fila pero avanza r√°pido. Pedir "Special Fallafel Sandwich".</p>
            </div>
        </div>

        <!-- ITEM 6: PANTHEON -->
        <div class="activity-block" data-id="pantheon">
            <div class="activity-block-header">
                <span class="activity-time-badge">14:15</span>
                <div class="activity-icon-badge"><i class="fas fa-monument"></i></div>
            </div>
            <div class="activity-block-title">Panth√©on</div>
            <div class="activity-block-subtitle">Tumbas de Voltaire, Rousseau...</div>
            <button class="expand-btn" onclick="toggleDetails(this)">
                Ver detalles <i class="fas fa-chevron-down"></i>
            </button>
            <div class="activity-details-container">
                <div class="schedule-tags">
                    <span class="schedule-tag tag-ticket">11.50‚Ç¨</span>
                </div>
                <p style="font-size:0.85rem; margin-top:10px;">Impresionante interior neocl√°sico. Mucho menos concurrido que otros museos.</p>
            </div>
        </div>

        <!-- ITEM 7: SHAKESPEARE & CO -->
        <div class="activity-block" data-id="shakespeare">
            <div class="activity-block-header">
                <span class="activity-time-badge">15:30</span>
                <div class="activity-icon-badge"><i class="fas fa-book"></i></div>
            </div>
            <div class="activity-block-title">Shakespeare & Co.</div>
            <div class="activity-block-subtitle">Librer√≠a hist√≥rica</div>
            <button class="expand-btn" onclick="toggleDetails(this)">
                Ver detalles <i class="fas fa-chevron-down"></i>
            </button>
            <div class="activity-details-container">
                <div class="schedule-tags">
                    <span class="schedule-tag tag-free-entry">Gratis</span>
                </div>
                <p style="font-size:0.85rem; margin-top:10px;">Entrar a curiosear (puede haber fila). Ambiente m√°gico y c√°lido.</p>
            </div>
        </div>

        <!-- ITEM 8: PETIT PALAIS -->
        <div class="activity-block" data-id="petit-palais">
            <div class="activity-block-header">
                <span class="activity-time-badge">16:30</span>
                <div class="activity-icon-badge"><i class="fas fa-palette"></i></div>
            </div>
            <div class="activity-block-title">Petit Palais</div>
            <div class="activity-block-subtitle">Museo de Bellas Artes</div>
            <button class="expand-btn" onclick="toggleDetails(this)">
                Ver detalles <i class="fas fa-chevron-down"></i>
            </button>
            <div class="activity-details-container">
                <div class="schedule-tags">
                    <span class="schedule-tag tag-free-entry">Gratis</span>
                </div>
                <p style="font-size:0.85rem; margin-top:10px;">Colecci√≥n permanente gratuita. El edificio es una joya y tiene un jard√≠n interior precioso.</p>
            </div>
        </div>

        <!-- ITEM 9: PASSAGE PANORAMAS -->
        <div class="activity-block" data-id="panoramas">
            <div class="activity-block-header">
                <span class="activity-time-badge">18:00</span>
                <div class="activity-icon-badge"><i class="fas fa-store"></i></div>
            </div>
            <div class="activity-block-title">Passage des Panoramas</div>
            <div class="activity-block-subtitle">Galer√≠a cubierta vintage</div>
            <button class="expand-btn" onclick="toggleDetails(this)">
                Ver detalles <i class="fas fa-chevron-down"></i>
            </button>
            <div class="activity-details-container">
                <p style="font-size:0.85rem; margin-top:10px;">Perfecto para escapar del fr√≠o. Tiendas de sellos, monedas y bistros antiguos.</p>
            </div>
        </div>

        <!-- ITEM 10: GALERIES LAFAYETTE -->
        <div class="activity-block" data-id="lafayette">
            <div class="activity-block-header">
                <span class="activity-time-badge">19:00</span>
                <div class="activity-icon-badge"><i class="fas fa-shopping-bag"></i></div>
            </div>
            <div class="activity-block-title">Galeries Lafayette</div>
            <div class="activity-block-subtitle">Rooftop View & C√∫pula</div>
            <button class="expand-btn" onclick="toggleDetails(this)">
                Ver detalles <i class="fas fa-chevron-down"></i>
            </button>
            <div class="activity-details-container">
                <div class="schedule-tags">
                    <span class="schedule-tag tag-free-entry">Gratis</span>
                </div>
                <p style="font-size:0.85rem; margin-top:10px;">Subir a la terraza (7mo piso) para vista gratis de la Torre Eiffel. Ver la c√∫pula desde adentro.</p>
            </div>
        </div>

        <!-- ITEM 11: LOUVRE -->
        <div class="activity-block" data-id="louvre">
            <div class="activity-block-header">
                <span class="activity-time-badge">20:00</span>
                <div class="activity-icon-badge"><i class="fas fa-paint-brush"></i></div>
            </div>
            <div class="activity-block-title">Louvre Nocturno</div>
            <div class="activity-block-subtitle">Abierto hasta 21:45 (Mi√©rcoles)</div>
            <button class="expand-btn" onclick="toggleDetails(this)">
                Ver detalles <i class="fas fa-chevron-down"></i>
            </button>
            <div class="activity-details-container">
                <div class="schedule-tags">
                    <span class="schedule-tag tag-ticket">22‚Ç¨</span>
                </div>
                <p style="font-size:0.85rem; margin-top:10px;">Aprovechar horario nocturno con menos gente. Ruta express: Mona Lisa, Venus, Victoria Alada.</p>
            </div>
        </div>

    </div>
    
    <!-- Spacer for FAB -->
    <div style="height: 100px;"></div>

    <script>
        // Init logic for Day 1
        setTimeout(() => {
            // 1. Initialize Map
            const mapContainer = document.getElementById('map-day1');
            if (mapContainer && !mapContainer._leaflet_id) {
                const map = L.map('map-day1').setView([48.8566, 2.3522], 13); // Center of Paris

                L.tileLayer('https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png', {
                    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OSM</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',
                    subdomains: 'abcd',
                    maxZoom: 20
                }).addTo(map);

                // Define stops
                const stops = [
                    { name: "Hotel Caron", lat: 48.8569, lng: 2.3582 },
                    { name: "Notre Dame", lat: 48.8529, lng: 2.3500 },
                    { name: "Sainte-Chapelle", lat: 48.8554, lng: 2.3450 },
                    { name: "L'As du Fallafel", lat: 48.8574, lng: 2.3591 },
                    { name: "Panth√©on", lat: 48.8462, lng: 2.3464 },
                    { name: "Shakespeare & Co", lat: 48.8519, lng: 2.3470 },
                    { name: "Petit Palais", lat: 48.8661, lng: 2.3144 },
                    { name: "Passage Panoramas", lat: 48.8714, lng: 2.3424 },
                    { name: "Galeries Lafayette", lat: 48.8737, lng: 2.3322 },
                    { name: "Louvre", lat: 48.8606, lng: 2.3376 }
                ];

                // Add route line
                const latlngs = stops.map(s => [s.lat, s.lng]);
                const polyline = L.polyline(latlngs, {color: '#0A2540', weight: 4, opacity: 0.8, dashArray: '10, 10'}).addTo(map);
                
                // Add markers
                stops.forEach((stop, index) => {
                    const markerHtml = `
                        <div style="background-color: #00D4FF; width: 20px; height: 20px; border-radius: 50%; border: 3px solid white; box-shadow: 0 2px 5px rgba(0,0,0,0.3);"></div>
                    `;
                    const icon = L.divIcon({
                        className: 'custom-div-icon',
                        html: markerHtml,
                        iconSize: [20, 20],
                        iconAnchor: [10, 10]
                    });
                    
                    L.marker([stop.lat, stop.lng], {icon: icon})
                        .addTo(map)
                        .bindPopup(`<b>${index + 1}. ${stop.name}</b>`);
                });

                // Fit bounds to show all points
                map.fitBounds(polyline.getBounds(), {padding: [50, 50]});
            }

            // 2. Initialize Sortable
            const grid = document.getElementById('activityGridDay1');
            if (grid) {
                new Sortable(grid, {
                    animation: 150,
                    ghostClass: 'sortable-ghost',
                    dragClass: 'sortable-drag',
                    delay: 100, // slight delay to prevent accidental drags on touch
                    delayOnTouchOnly: true
                });
            }

        }, 100);

        // Toggle Details Function
        window.toggleDetails = function(btn) {
            const container = btn.nextElementSibling;
            container.classList.toggle('open');
            const icon = btn.querySelector('i');
            if (container.classList.contains('open')) {
                btn.innerHTML = 'Ver menos <i class="fas fa-chevron-up"></i>';
                btn.style.background = "#E0F7FF";
                btn.style.color = "#0077B6";
            } else {
                btn.innerHTML = 'Ver detalles <i class="fas fa-chevron-down"></i>';
                btn.style.background = "#F7FAFC";
                btn.style.color = "#718096";
            }
        };
    </script>
</div>
